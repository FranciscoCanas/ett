<% package = Package.find(pac_id) %>
<form action="/packages/<%= pac_id %>"
      id="pac_<%= pac_id %>_<%= field_name %>_form"
      method="post"
      onsubmit="new Ajax.Request('/packages/<%=pac_id%>',
              {
                      asynchronous:true, evalScripts:true,
                      onLoading:function(request) {Element.show('pac_<%=pac_id%>_<%=field_name%>_spinner');},
                      onSuccess:function(request) {

                              },
                      parameters:Form.serialize(this)
                      });return false;">

  <%= hidden_field_tag '_method', 'put' %>
  <%= hidden_field_tag :id, pac_id %>
  <%= hidden_field_tag :div, "pac_#{pac_id}_#{field_name}" %>
  <%= hidden_field_tag :user, params[:user] %>
  <%= hidden_field_tag :authenticity_token, form_authenticity_token %>
  <%= hidden_field_tag :is_xattr, is_xattr %>
  <%= render :partial => field_type, :locals => {:package => Package.find(pac_id), :field_name => field_name} %>
  <% if field_name == 'StatusId' && force_bz_auth?(package) %>
      <% if package.status.blank? %>
          <input type='submit' value='Submit' onclick='return checkBzAuthInfo(<%=pac_id%>);'/>
      <% else %>
          <input type='submit' value='Submit' onclick='return checkBzAuthInfo(<%=pac_id%>, <%=package.status.id%>);'/>
      <% end %>
  <% elsif field_name == 'Ver' %>
        <%# Dustin, please implement version format checking. you need to write a function in package index page and do the format checking.
            You can check checkBzAuthInfo() in packages/index.html.erb as example.
         %>
        <%# (rdb:2) field_type
"packages/index/field_input"
(rdb:2) field_name
"Ver" %>


  <% else %>
      <%= submit_tag 'Update' %>
  <% end %>
  <input type="button" value="Cancel" onclick="hide_pac_editor('pac_<%= pac_id %>_<%=field_name%>','<%=field_type%>', '<%=is_xattr%>')"/>
  <%= render :partial => 'layouts/progress_indicator', :locals => {:progress_indicator_id => "pac_#{pac_id}_#{field_name}_spinner"} %>

  <% if field_name == 'StatusId' && force_bz_auth?(package) %>
      <%= render :partial => 'layouts/sep' %>
      <%= render :partial => 'bz_bugs/bz_auth', :locals => {:id => package.id} %>
  <% end %>

</form>